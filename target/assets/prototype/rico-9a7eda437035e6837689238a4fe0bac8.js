var Rico={Version:"1.1-beta2",ArrayExtensions:[]};Object.prototype.extend&&(Rico.ArrayExtensions[Rico.ArrayExtensions.length]=Object.prototype.extend);Array.prototype.push&&(Rico.ArrayExtensions[Rico.ArrayExtensions.length]=Array.prototype.push);Array.prototype.remove||(Array.prototype.remove=function(a){if(isNaN(a)||a>this.length)return!1;for(var b=0,c=0;b<this.length;b++)b!=a&&(this[c++]=this[b]);--this.length},Rico.ArrayExtensions[Rico.ArrayExtensions.length]=Array.prototype.remove);
Array.prototype.removeItem||(Array.prototype.removeItem=function(a){for(var b=0;b<this.length;b++)if(this[b]==a){this.remove(b);break}},Rico.ArrayExtensions[Rico.ArrayExtensions.length]=Array.prototype.removeItem);Array.prototype.indices||(Array.prototype.indices=function(){var a=[];for(index in this){for(var b=!1,c=0;c<Rico.ArrayExtensions.length;c++)if(this[index]==Rico.ArrayExtensions[c]){b=!0;break}b||(a[a.length]=index)}return a},Rico.ArrayExtensions[Rico.ArrayExtensions.length]=Array.prototype.indices);
window.DOMParser&&window.XMLSerializer&&window.Node&&Node.prototype&&Node.prototype.__defineGetter__&&(Document.prototype.loadXML||(Document.prototype.loadXML=function(a){for(a=(new DOMParser).parseFromString(a,"text/xml");this.hasChildNodes();)this.removeChild(this.lastChild);for(var b=0;b<a.childNodes.length;b++)this.appendChild(this.importNode(a.childNodes[b],!0))}),Document.prototype.__defineGetter__("xml",function(){return(new XMLSerializer).serializeToString(this)}));
document.getElementsByTagAndClassName=function(a,b){null==a&&(a="*");var c=document.getElementsByTagName(a)||document.all,d=[];if(null==b)return c;for(var e=0;e<c.length;e++)for(var f=c[e],g=f.className.split(" "),h=0;h<g.length;h++)if(g[h]==b){d.push(f);break}return d};Rico.Accordion=Class.create();
Rico.Accordion.prototype={initialize:function(a,b){this.container=$(a);this.lastExpandedTab=null;this.accordionTabs=[];this.setOptions(b);this._attachBehaviors();this.container.style.borderBottom="1px solid "+this.options.borderColor;for(var c=1;c<this.accordionTabs.length;c++)this.accordionTabs[c].collapse(),this.accordionTabs[c].content.style.display="none";this.lastExpandedTab=this.accordionTabs[0];this.lastExpandedTab.content.style.height=this.options.panelHeight+"px";this.lastExpandedTab.showExpanded();
this.lastExpandedTab.titleBar.style.fontWeight=this.options.expandedFontWeight},setOptions:function(a){this.options={expandedBg:"#63699c",hoverBg:"#63699c",collapsedBg:"#6b79a5",expandedTextColor:"#ffffff",expandedFontWeight:"bold",hoverTextColor:"#ffffff",collapsedTextColor:"#ced7ef",collapsedFontWeight:"normal",hoverTextColor:"#ffffff",borderColor:"#1f669b",panelHeight:200,onHideTab:null,onShowTab:null}.extend(a||{})},showTabByIndex:function(a,b){this.showTab(this.accordionTabs[a],1==arguments.length?
!0:b)},showTab:function(a,b){var c=1==arguments.length?!0:b;if(this.options.onHideTab)this.options.onHideTab(this.lastExpandedTab);this.lastExpandedTab.showCollapsed();var d=this,e=this.lastExpandedTab;this.lastExpandedTab.content.style.height=this.options.panelHeight-1+"px";a.content.style.display="";a.titleBar.style.fontWeight=this.options.expandedFontWeight;c?(new Effect.AccordionSize(this.lastExpandedTab.content,a.content,1,this.options.panelHeight,100,10,{complete:function(){d.showTabDone(e)}}),
this.lastExpandedTab=a):(this.lastExpandedTab.content.style.height="1px",a.content.style.height=this.options.panelHeight+"px",this.lastExpandedTab=a,this.showTabDone(e))},showTabDone:function(a){a.content.style.display="none";this.lastExpandedTab.showExpanded();if(this.options.onShowTab)this.options.onShowTab(this.lastExpandedTab)},_attachBehaviors:function(){for(var a=this._getDirectChildrenByTag(this.container,"DIV"),b=0;b<a.length;b++){var c=this._getDirectChildrenByTag(a[b],"DIV");2==c.length&&
this.accordionTabs.push(new Rico.Accordion.Tab(this,c[0],c[1]))}},_getDirectChildrenByTag:function(a,b){for(var c=[],d=a.childNodes,e=0;e<d.length;e++)d[e]&&d[e].tagName&&d[e].tagName==b&&c.push(d[e]);return c}};Rico.Accordion.Tab=Class.create();
Rico.Accordion.Tab.prototype={initialize:function(a,b,c){this.accordion=a;this.titleBar=b;this.content=c;this._attachBehaviors()},collapse:function(){this.showCollapsed();this.content.style.height="1px"},showCollapsed:function(){this.expanded=!1;this.titleBar.style.backgroundColor=this.accordion.options.collapsedBg;this.titleBar.style.color=this.accordion.options.collapsedTextColor;this.titleBar.style.fontWeight=this.accordion.options.collapsedFontWeight;this.content.style.overflow="hidden"},showExpanded:function(){this.expanded=
!0;this.titleBar.style.backgroundColor=this.accordion.options.expandedBg;this.titleBar.style.color=this.accordion.options.expandedTextColor;this.content.style.overflow="visible"},titleBarClicked:function(a){this.accordion.lastExpandedTab!=this&&this.accordion.showTab(this)},hover:function(a){this.titleBar.style.backgroundColor=this.accordion.options.hoverBg;this.titleBar.style.color=this.accordion.options.hoverTextColor},unhover:function(a){this.expanded?(this.titleBar.style.backgroundColor=this.accordion.options.expandedBg,
this.titleBar.style.color=this.accordion.options.expandedTextColor):(this.titleBar.style.backgroundColor=this.accordion.options.collapsedBg,this.titleBar.style.color=this.accordion.options.collapsedTextColor)},_attachBehaviors:function(){this.content.style.border="1px solid "+this.accordion.options.borderColor;this.content.style.borderTopWidth="0px";this.content.style.borderBottomWidth="0px";this.content.style.margin="0px";this.titleBar.onclick=this.titleBarClicked.bindAsEventListener(this);this.titleBar.onmouseover=
this.hover.bindAsEventListener(this);this.titleBar.onmouseout=this.unhover.bindAsEventListener(this)}};Rico.AjaxEngine=Class.create();
Rico.AjaxEngine.prototype={initialize:function(){this.ajaxElements=[];this.ajaxObjects=[];this.requestURLS=[]},registerAjaxElement:function(a,b){1==arguments.length&&(b=$(a));this.ajaxElements[a]=b},registerAjaxObject:function(a,b){this.ajaxObjects[a]=b},registerRequest:function(a,b){this.requestURLS[a]=b},sendRequest:function(a){var b=this.requestURLS[a];if(null!=b){var c="";1<arguments.length&&(c="object"==typeof arguments[1]&&void 0!=arguments[1].length?this._createQueryString(arguments[1],0):
this._createQueryString(arguments,1));new Ajax.Request(b,this._requestOptions(c))}},sendRequestWithData:function(a,b){var c=this.requestURLS[a];if(null!=c){var d="";2<arguments.length&&(d="object"==typeof arguments[2]&&void 0!=arguments[2].length?this._createQueryString(arguments[2],0):this._createQueryString(arguments,2));new Ajax.Request(c+"?"+d,this._requestOptions(null,b))}},sendRequestAndUpdate:function(a,b,c){var d=this.requestURLS[a];if(null!=d){var e="";3<arguments.length&&(e="object"==typeof arguments[3]&&
void 0!=arguments[3].length?this._createQueryString(arguments[3],0):this._createQueryString(arguments,3));e=this._requestOptions(e);e.onComplete=null;e.extend(c);new Ajax.Updater(b,d,e)}},sendRequestWithDataAndUpdate:function(a,b,c,d){var e=this.requestURLS[a];if(null!=e){var f="";4<arguments.length&&(f="object"==typeof arguments[4]&&void 0!=arguments[4].length?this._createQueryString(arguments[4],0):this._createQueryString(arguments,4));var g=this._requestOptions(f,b);g.onComplete=null;g.extend(d);
new Ajax.Updater(c,e+"?"+f,g)}},_requestOptions:function(a,b){var c=["X-Rico-Version",Rico.Version],d="post";b?c.push("Content-type","text/xml"):d="get";return{requestHeaders:c,parameters:a,postBody:b?b:null,method:d,onComplete:this._onRequestComplete.bind(this)}},_createQueryString:function(a,b){for(var c="",d=b;d<a.length;d++){d!=b&&(c+="&");var e=a[d];if(void 0!=e.name&&void 0!=e.value)c+=e.name+"="+escape(e.value);else var f=e.indexOf("="),g=e.substring(0,f),e=e.substring(f+1),c=c+(g+"="+escape(e))}return c},
_onRequestComplete:function(a){200==a.status&&(a=a.responseXML.getElementsByTagName("ajax-response"),null!=a&&1==a.length&&this._processAjaxResponse(a[0].childNodes))},_processAjaxResponse:function(a){for(var b=0;b<a.length;b++){var c=a[b];if(1==c.nodeType){var d=c.getAttribute("type"),e=c.getAttribute("id");"object"==d?this._processAjaxObjectUpdate(this.ajaxObjects[e],c):"element"==d?this._processAjaxElementUpdate(this.ajaxElements[e],c):alert("unrecognized AjaxResponse type : "+d)}}},_processAjaxObjectUpdate:function(a,
b){a.ajaxUpdate(b)},_processAjaxElementUpdate:function(a,b){a.innerHTML=RicoUtil.getContentAsString(b)}};var ajaxEngine=new Rico.AjaxEngine;Rico.Color=Class.create();
Rico.Color.prototype={initialize:function(a,b,c){this.rgb={r:a,g:b,b:c}},setRed:function(a){this.rgb.r=a},setGreen:function(a){this.rgb.g=a},setBlue:function(a){this.rgb.b=a},setHue:function(a){var b=this.asHSB();b.h=a;this.rgb=Rico.Color.HSBtoRGB(b.h,b.s,b.b)},setSaturation:function(a){var b=this.asHSB();b.s=a;this.rgb=Rico.Color.HSBtoRGB(b.h,b.s,b.b)},setBrightness:function(a){var b=this.asHSB();b.b=a;this.rgb=Rico.Color.HSBtoRGB(b.h,b.s,b.b)},darken:function(a){var b=this.asHSB();this.rgb=Rico.Color.HSBtoRGB(b.h,
b.s,Math.max(b.b-a,0))},brighten:function(a){var b=this.asHSB();this.rgb=Rico.Color.HSBtoRGB(b.h,b.s,Math.min(b.b+a,1))},blend:function(a){this.rgb.r=Math.floor((this.rgb.r+a.rgb.r)/2);this.rgb.g=Math.floor((this.rgb.g+a.rgb.g)/2);this.rgb.b=Math.floor((this.rgb.b+a.rgb.b)/2)},isBright:function(){this.asHSB();return.5<this.asHSB().b},isDark:function(){return!this.isBright()},asRGB:function(){return"rgb("+this.rgb.r+","+this.rgb.g+","+this.rgb.b+")"},asHex:function(){return"#"+this.rgb.r.toColorPart()+
this.rgb.g.toColorPart()+this.rgb.b.toColorPart()},asHSB:function(){return Rico.Color.RGBtoHSB(this.rgb.r,this.rgb.g,this.rgb.b)},toString:function(){return this.asHex()}};Rico.Color.createFromHex=function(a){0==a.indexOf("#")&&(a=a.substring(1));var b=a.substring(0,2),c=a.substring(2,4);a=a.substring(4,6);return new Rico.Color(parseInt(b,16),parseInt(c,16),parseInt(a,16))};
Rico.Color.createColorFromBackground=function(a){var b=RicoUtil.getElementsComputedStyle($(a),"backgroundColor","background-color");if("transparent"==b&&a.parent)return Rico.Color.createColorFromBackground(a.parent);if(null==b)return new Rico.Color(255,255,255);if(0==b.indexOf("rgb("))return b=b.substring(4,b.length-1).split(","),new Rico.Color(parseInt(b[0]),parseInt(b[1]),parseInt(b[2]));if(0==b.indexOf("#")){a=parseInt(b.substring(1,3),16);var c=parseInt(b.substring(3,5),16),b=parseInt(b.substring(5),
16);return new Rico.Color(a,c,b)}return new Rico.Color(255,255,255)};
Rico.Color.HSBtoRGB=function(a,b,c){var d=0,e=0,f=0;if(0==b)f=e=d=parseInt(255*c+.5);else{a=6*(a-Math.floor(a));var g=a-Math.floor(a),h=c*(1-b),k=c*(1-b*g);b=c*(1-b*(1-g));switch(parseInt(a)){case 0:d=255*c+.5;e=255*b+.5;f=255*h+.5;break;case 1:d=255*k+.5;e=255*c+.5;f=255*h+.5;break;case 2:d=255*h+.5;e=255*c+.5;f=255*b+.5;break;case 3:d=255*h+.5;e=255*k+.5;f=255*c+.5;break;case 4:d=255*b+.5;e=255*h+.5;f=255*c+.5;break;case 5:d=255*c+.5,e=255*h+.5,f=255*k+.5}}return{r:parseInt(d),g:parseInt(e),b:parseInt(f)}};
Rico.Color.RGBtoHSB=function(a,b,c){var d=a>b?a:b;c>d&&(d=c);var e=a<b?a:b;c<e&&(e=c);saturation=0!=d?(d-e)/d:0;if(0==saturation)a=0;else{var f=(d-a)/(d-e),g=(d-b)/(d-e);c=(d-c)/(d-e);a=(a==d?c-g:b==d?2+f-c:4+g-f)/6;0>a&&(a+=1)}return{h:a,s:saturation,b:d/255}};
Rico.Corner={round:function(a,b){a=$(a);this._setOptions(b);var c=this.options.color;"fromElement"==this.options.color&&(c=this._background(a));var d=this.options.bgColor;"fromParent"==this.options.bgColor&&(d=this._background(a.offsetParent));this._roundCornersImpl(a,c,d)},_roundCornersImpl:function(a,b,c){this.options.border&&this._renderBorder(a,c);this._isTopRounded()&&this._roundTopCorners(a,b,c);this._isBottomRounded()&&this._roundBottomCorners(a,b,c)},_renderBorder:function(a,b){var c="1px solid "+
this._borderColor(b);a.innerHTML="<div "+("style='border-left: "+c+";"+("border-right: "+c)+"'")+">"+a.innerHTML+"</div>"},_roundTopCorners:function(a,b,c){for(var d=this._createCorner(c),e=0;e<this.options.numSlices;e++)d.appendChild(this._createCornerSlice(b,c,e,"top"));a.style.paddingTop=0;a.insertBefore(d,a.firstChild)},_roundBottomCorners:function(a,b,c){for(var d=this._createCorner(c),e=this.options.numSlices-1;0<=e;e--)d.appendChild(this._createCornerSlice(b,c,e,"bottom"));a.style.paddingBottom=
0;a.appendChild(d)},_createCorner:function(a){var b=document.createElement("div");b.style.backgroundColor=this._isTransparent()?"transparent":a;return b},_createCornerSlice:function(a,b,c,d){var e=document.createElement("span"),f=e.style;f.backgroundColor=a;f.display="block";f.height="1px";f.overflow="hidden";f.fontSize="1px";a=this._borderColor(a,b);this.options.border&&0==c?(f.borderTopStyle="solid",f.borderTopWidth="1px",f.borderLeftWidth="0px",f.borderRightWidth="0px",f.borderBottomWidth="0px",
f.height="0px",f.borderColor=a):a&&(f.borderColor=a,f.borderStyle="solid",f.borderWidth="0px 1px");this.options.compact||c!=this.options.numSlices-1||(f.height="2px");this._setMargin(e,c,d);this._setBorder(e,c,d);return e},_setOptions:function(a){this.options={corners:"all",color:"fromElement",bgColor:"fromParent",blend:!0,border:!1,compact:!1}.extend(a||{});this.options.numSlices=this.options.compact?2:4;this._isTransparent()&&(this.options.blend=!1)},_whichSideTop:function(){return this._hasString(this.options.corners,
"all","top")||0<=this.options.corners.indexOf("tl")&&0<=this.options.corners.indexOf("tr")?"":0<=this.options.corners.indexOf("tl")?"left":0<=this.options.corners.indexOf("tr")?"right":""},_whichSideBottom:function(){return this._hasString(this.options.corners,"all","bottom")||0<=this.options.corners.indexOf("bl")&&0<=this.options.corners.indexOf("br")?"":0<=this.options.corners.indexOf("bl")?"left":0<=this.options.corners.indexOf("br")?"right":""},_borderColor:function(a,b){return"transparent"==
a?b:this.options.border?this.options.border:this.options.blend?this._blend(b,a):""},_setMargin:function(a,b,c){b=this._marginSize(b);c="top"==c?this._whichSideTop():this._whichSideBottom();"left"==c?(a.style.marginLeft=b+"px",a.style.marginRight="0px"):"right"==c?(a.style.marginRight=b+"px",a.style.marginLeft="0px"):(a.style.marginLeft=b+"px",a.style.marginRight=b+"px")},_setBorder:function(a,b,c){b=this._borderSize(b);c="top"==c?this._whichSideTop():this._whichSideBottom();"left"==c?(a.style.borderLeftWidth=
b+"px",a.style.borderRightWidth="0px"):"right"==c?(a.style.borderRightWidth=b+"px",a.style.borderLeftWidth="0px"):(a.style.borderLeftWidth=b+"px",a.style.borderRightWidth=b+"px")},_marginSize:function(a){if(this._isTransparent())return 0;var b=[5,3,2,1],c=[3,2,1,0],d=[2,1],e=[1,0];return this.options.compact&&this.options.blend?e[a]:this.options.compact?d[a]:this.options.blend?c[a]:b[a]},_borderSize:function(a){var b=[5,3,2,1],c=[2,1,1,1],d=[1,0],e=[0,2,0,0];return this.options.compact&&(this.options.blend||
this._isTransparent())?1:this.options.compact?d[a]:this.options.blend?c[a]:this.options.border?e[a]:this._isTransparent()?b[a]:0},_hasString:function(a){for(var b=1;b<arguments.length;b++)if(0<=a.indexOf(arguments[b]))return!0;return!1},_blend:function(a,b){var c=Rico.Color.createFromHex(a);c.blend(Rico.Color.createFromHex(b));return c},_background:function(a){try{return Rico.Color.createColorFromBackground(a).asHex()}catch(b){return"#ffffff"}},_isTransparent:function(){return"transparent"==this.options.color},
_isTopRounded:function(){return this._hasString(this.options.corners,"all","top","tl","tr")},_isBottomRounded:function(){return this._hasString(this.options.corners,"all","bottom","bl","br")},_hasSingleTextChild:function(a){return 1==a.childNodes.length&&3==a.childNodes[0].nodeType}};Rico.DragAndDrop=Class.create();
Rico.DragAndDrop.prototype={initialize:function(){this.dropZones=[];this.draggables=[];this.currentDragObjects=[];this.lastSelectedDraggable=this.dragElement=null;this.interestedInMotionEvents=this.currentDragObjectVisible=!1},registerDropZone:function(a){this.dropZones[this.dropZones.length]=a},deregisterDropZone:function(a){for(var b=[],c=0,d=0;d<this.dropZones.length;d++)this.dropZones[d]!=a&&(b[c++]=this.dropZones[d]);this.dropZones=b},clearDropZones:function(){this.dropZones=[]},registerDraggable:function(a){this.draggables[this.draggables.length]=
a;this._addMouseDownHandler(a)},clearSelection:function(){for(var a=0;a<this.currentDragObjects.length;a++)this.currentDragObjects[a].deselect();this.currentDragObjects=[];this.lastSelectedDraggable=null},hasSelection:function(){return 0<this.currentDragObjects.length},setStartDragFromElement:function(a,b){this.origPos=RicoUtil.toDocumentPosition(b);this.startx=a.screenX-this.origPos.x;this.starty=a.screenY-this.origPos.y;this.interestedInMotionEvents=this.hasSelection();this._terminateEvent(a)},
updateSelection:function(a,b){b||this.clearSelection();a.isSelected()?(this.currentDragObjects.removeItem(a),a.deselect(),a==this.lastSelectedDraggable&&(this.lastSelectedDraggable=null)):(this.currentDragObjects[this.currentDragObjects.length]=a,a.select(),this.lastSelectedDraggable=a)},_mouseDownHandler:function(a){0==arguments.length&&(a=event);var b=void 0!=a.which;if(!(b&&1!=a.which||!b&&1!=a.button)){for(var c=a.target?a.target:a.srcElement,b=c.draggable;null==b&&c.parentNode;)c=c.parentNode,
b=c.draggable;if(null!=b){this.updateSelection(b,a.ctrlKey);if(this.hasSelection())for(c=0;c<this.dropZones.length;c++)this.dropZones[c].clearPositionCache();this.setStartDragFromElement(a,b.getMouseDownHTMLElement())}}},_mouseMoveHandler:function(a){this.interestedInMotionEvents?this.hasSelection()&&(this.currentDragObjectVisible||this._startDrag(a),this.activatedDropZones||this._activateRegisteredDropZones(),this._updateDraggableLocation(a),this._updateDropZonesHover(a),this._terminateEvent(a)):
this._terminateEvent(a)},_makeDraggableObjectVisible:function(a){if(this.hasSelection()){var b;b=1<this.currentDragObjects.length?this.currentDragObjects[0].getMultiObjectDragGUI(this.currentDragObjects):this.currentDragObjects[0].getSingleObjectDragGUI();"absolute"!=RicoUtil.getElementsComputedStyle(b,"position")&&(b.style.position="absolute");null!=b.parentNode&&11!=b.parentNode.nodeType||document.body.appendChild(b);this.dragElement=b;this._updateDraggableLocation(a);this.currentDragObjectVisible=
!0}},_updateDraggableLocation:function(a){var b=this.dragElement.style;b.left=a.screenX-this.startx+"px";b.top=a.screenY-this.starty+"px"},_updateDropZonesHover:function(a){for(var b=this.dropZones.length,c=0;c<b;c++)this._mousePointInDropZone(a,this.dropZones[c])||this.dropZones[c].hideHover();for(c=0;c<b;c++)this._mousePointInDropZone(a,this.dropZones[c])&&this.dropZones[c].canAccept(this.currentDragObjects)&&this.dropZones[c].showHover()},_startDrag:function(a){for(var b=0;b<this.currentDragObjects.length;b++)this.currentDragObjects[b].startDrag();
this._makeDraggableObjectVisible(a)},_mouseUpHandler:function(a){if(this.hasSelection()){var b=void 0!=a.which;b&&1!=a.which||!b&&1!=a.button||(this.interestedInMotionEvents=!1,null==this.dragElement?this._terminateEvent(a):this._placeDraggableInDropZone(a)?this._completeDropOperation(a):(this._terminateEvent(a),new Effect.Position(this.dragElement,this.origPos.x,this.origPos.y,200,20,{complete:this._doCancelDragProcessing.bind(this)})))}},_completeDropOperation:function(a){this.dragElement!=this.currentDragObjects[0].getMouseDownHTMLElement()&&
null!=this.dragElement.parentNode&&this.dragElement.parentNode.removeChild(this.dragElement);this._deactivateRegisteredDropZones();this._endDrag();this.clearSelection();this.dragElement=null;this.currentDragObjectVisible=!1;this._terminateEvent(a)},_doCancelDragProcessing:function(){this._cancelDrag();this.dragElement!=this.currentDragObjects[0].getMouseDownHTMLElement()&&null!=this.dragElement.parentNode&&this.dragElement.parentNode.removeChild(this.dragElement);this._deactivateRegisteredDropZones();
this.dragElement=null;this.currentDragObjectVisible=!1},_placeDraggableInDropZone:function(a){for(var b=!1,c=this.dropZones.length,d=0;d<c;d++)if(this._mousePointInDropZone(a,this.dropZones[d])&&this.dropZones[d].canAccept(this.currentDragObjects)){this.dropZones[d].hideHover();this.dropZones[d].accept(this.currentDragObjects);b=!0;break}return b},_cancelDrag:function(){for(var a=0;a<this.currentDragObjects.length;a++)this.currentDragObjects[a].cancelDrag()},_endDrag:function(){for(var a=0;a<this.currentDragObjects.length;a++)this.currentDragObjects[a].endDrag()},
_mousePointInDropZone:function(a,b){var c=b.getAbsoluteRect();return a.clientX>c.left&&a.clientX<c.right&&a.clientY>c.top&&a.clientY<c.bottom},_addMouseDownHandler:function(a){var b=a.getMouseDownHTMLElement();null!=b&&(b.draggable=a,this._addMouseDownEvent(b))},_activateRegisteredDropZones:function(){for(var a=this.dropZones.length,b=0;b<a;b++){var c=this.dropZones[b];c.canAccept(this.currentDragObjects)&&c.activate()}this.activatedDropZones=!0},_deactivateRegisteredDropZones:function(){for(var a=
this.dropZones.length,b=0;b<a;b++)this.dropZones[b].deactivate();this.activatedDropZones=!1},_addMouseDownEvent:function(a){"undefined"!=typeof document.implementation&&document.implementation.hasFeature("HTML","1.0")&&document.implementation.hasFeature("Events","2.0")&&document.implementation.hasFeature("CSS","2.0")?a.addEventListener("mousedown",this._mouseDownHandler.bindAsEventListener(this),!1):a.attachEvent("onmousedown",this._mouseDownHandler.bindAsEventListener(this))},_terminateEvent:function(a){void 0!=
a.stopPropagation?a.stopPropagation():void 0!=a.cancelBubble&&(a.cancelBubble=!0);void 0!=a.preventDefault?a.preventDefault():a.returnValue=!1},initializeEventHandlers:function(){"undefined"!=typeof document.implementation&&document.implementation.hasFeature("HTML","1.0")&&document.implementation.hasFeature("Events","2.0")&&document.implementation.hasFeature("CSS","2.0")?(document.addEventListener("mouseup",this._mouseUpHandler.bindAsEventListener(this),!1),document.addEventListener("mousemove",this._mouseMoveHandler.bindAsEventListener(this),
!1)):(document.attachEvent("onmouseup",this._mouseUpHandler.bindAsEventListener(this)),document.attachEvent("onmousemove",this._mouseMoveHandler.bindAsEventListener(this)))}};Rico.Draggable=Class.create();
Rico.Draggable.prototype={initialize:function(a,b){this.type=a;this.htmlElement=$(b);this.selected=!1},getMouseDownHTMLElement:function(){return this.htmlElement},select:function(){this.selected=!0;if(!this.showingSelected){var a=this.getMouseDownHTMLElement(),b=Rico.Color.createColorFromBackground(a);b.isBright()?b.darken(.033):b.brighten(.033);this.saveBackground=RicoUtil.getElementsComputedStyle(a,"backgroundColor","background-color");a.style.backgroundColor=b.asHex();this.showingSelected=!0}},
deselect:function(){this.selected=!1;this.showingSelected&&(this.getMouseDownHTMLElement().style.backgroundColor=this.saveBackground,this.showingSelected=!1)},isSelected:function(){return this.selected},startDrag:function(){},cancelDrag:function(){},endDrag:function(){},getSingleObjectDragGUI:function(){return this.htmlElement},getMultiObjectDragGUI:function(a){return this.htmlElement},getDroppedGUI:function(){return this.htmlElement},toString:function(){return this.type+":"+this.htmlElement+":"}};
Rico.Dropzone=Class.create();
Rico.Dropzone.prototype={initialize:function(a){this.htmlElement=$(a);this.absoluteRect=null},getHTMLElement:function(){return this.htmlElement},clearPositionCache:function(){this.absoluteRect=null},getAbsoluteRect:function(){if(null==this.absoluteRect){var a=this.getHTMLElement(),b=RicoUtil.toViewportPosition(a);this.absoluteRect={top:b.y,left:b.x,bottom:b.y+a.offsetHeight,right:b.x+a.offsetWidth}}return this.absoluteRect},activate:function(){var a=this.getHTMLElement();if(null!=a&&!this.showingActive){this.showingActive=
!0;this.saveBackgroundColor=a.style.backgroundColor;var b=Rico.Color.createColorFromBackground(a);null==b?a.style.backgroundColor="#ffea84":(b.isBright()?b.darken(.2):b.brighten(.2),a.style.backgroundColor=b.asHex())}},deactivate:function(){var a=this.getHTMLElement();null!=a&&this.showingActive&&(a.style.backgroundColor=this.saveBackgroundColor,this.showingActive=!1,this.saveBackgroundColor=null)},showHover:function(){var a=this.getHTMLElement();null==a||this.showingHover||(this.saveBorderWidth=
a.style.borderWidth,this.saveBorderStyle=a.style.borderStyle,this.saveBorderColor=a.style.borderColor,this.showingHover=!0,a.style.borderWidth="1px",a.style.borderStyle="solid",a.style.borderColor="#ffff00")},hideHover:function(){var a=this.getHTMLElement();null!=a&&this.showingHover&&(a.style.borderWidth=this.saveBorderWidth,a.style.borderStyle=this.saveBorderStyle,a.style.borderColor=this.saveBorderColor,this.showingHover=!1)},canAccept:function(a){return!0},accept:function(a){var b=this.getHTMLElement();
if(null!=b){n=a.length;for(var c=0;c<n;c++){var d=a[c].getDroppedGUI();"absolute"==RicoUtil.getElementsComputedStyle(d,"position")&&(d.style.position="static",d.style.top="",d.style.top="");b.appendChild(d)}}}};void 0==window.Effect&&(Effect={});Effect.SizeAndPosition=Class.create();
Effect.SizeAndPosition.prototype={initialize:function(a,b,c,d,e,f,g,h){this.element=$(a);this.x=b;this.y=c;this.w=d;this.h=e;this.duration=f;this.steps=g;this.options=h||{};this.sizeAndPosition()},sizeAndPosition:function(){if(this.isFinished())this.options.complete&&this.options.complete(this);else{this.timer&&clearTimeout(this.timer);var a=Math.round(this.duration/this.steps),b=this.element.offsetLeft,c=this.element.offsetTop,d=this.element.offsetWidth,e=this.element.offsetHeight;this.x=this.x?
this.x:b;this.y=this.y?this.y:c;this.w=this.w?this.w:d;this.h=this.h?this.h:e;d=0<this.steps?(this.w-d)/this.steps:0;e=0<this.steps?(this.h-e)/this.steps:0;this.moveBy(0<this.steps?(this.x-b)/this.steps:0,0<this.steps?(this.y-c)/this.steps:0);this.resizeBy(d,e);this.duration-=a;this.steps--;this.timer=setTimeout(this.sizeAndPosition.bind(this),a)}},isFinished:function(){return 0>=this.steps},moveBy:function(a,b){var c=this.element.offsetLeft,d=this.element.offsetTop,e=parseInt(a),f=parseInt(b),g=
this.element.style;0!=e&&(g.left=c+e+"px");0!=f&&(g.top=d+f+"px")},resizeBy:function(a,b){var c=this.element.offsetWidth,d=this.element.offsetHeight,e=parseInt(a),f=parseInt(b),g=this.element.style;0!=e&&(g.width=c+e+"px");0!=f&&(g.height=d+f+"px")}};Effect.Size=Class.create();Effect.Size.prototype={initialize:function(a,b,c,d,e,f){new Effect.SizeAndPosition(a,null,null,b,c,d,e,f)}};Effect.Position=Class.create();
Effect.Position.prototype={initialize:function(a,b,c,d,e,f){new Effect.SizeAndPosition(a,b,c,null,null,d,e,f)}};Effect.Round=Class.create();Effect.Round.prototype={initialize:function(a,b,c){a=document.getElementsByTagAndClassName(a,b);for(b=0;b<a.length;b++)Rico.Corner.round(a[b],c)}};Effect.FadeTo=Class.create();
Effect.FadeTo.prototype={initialize:function(a,b,c,d,e){this.element=$(a);this.opacity=b;this.duration=c;this.steps=d;this.options=e||{};this.fadeTo()},fadeTo:function(){if(this.isFinished())this.options.complete&&this.options.complete(this);else{this.timer&&clearTimeout(this.timer);var a=Math.round(this.duration/this.steps),b=this.getElementOpacity();this.changeOpacityBy(0<this.steps?(this.opacity-b)/this.steps:0);this.duration-=a;this.steps--;this.timer=setTimeout(this.fadeTo.bind(this),a)}},changeOpacityBy:function(a){var b=
this.getElementOpacity();a=Math.max(0,Math.min(b+a,1));this.element.ricoOpacity=a;this.element.style.filter="alpha(opacity:"+Math.round(100*a)+")";this.element.style.opacity=a},isFinished:function(){return 0>=this.steps},getElementOpacity:function(){if(void 0==this.element.ricoOpacity){var a;this.element.currentStyle?a=this.element.currentStyle.opacity:void 0!=document.defaultView.getComputedStyle&&(a=document.defaultView.getComputedStyle,a=a(this.element,null).getPropertyValue("opacity"));this.element.ricoOpacity=
void 0!=a?a:1}return parseFloat(this.element.ricoOpacity)}};Effect.AccordionSize=Class.create();
Effect.AccordionSize.prototype={initialize:function(a,b,c,d,e,f,g){this.e1=$(a);this.e2=$(b);this.start=c;this.end=d;this.duration=e;this.steps=f;this.options=g||{};this.accordionSize()},accordionSize:function(){if(this.isFinished())this.e1.style.height=this.start+"px",this.e2.style.height=this.end+"px",this.options.complete&&this.options.complete(this);else{this.timer&&clearTimeout(this.timer);var a=Math.round(this.duration/this.steps),b=0<this.steps?(parseInt(this.e1.offsetHeight)-this.start)/this.steps:
0;this.resizeBy(b);this.duration-=a;this.steps--;this.timer=setTimeout(this.accordionSize.bind(this),a)}},isFinished:function(){return 0>=this.steps},resizeBy:function(a){var b=this.e1.offsetHeight,c=this.e2.offsetHeight,d=parseInt(a);0!=a&&(this.e1.style.height=b-d+"px",this.e2.style.height=c+d+"px")}};Rico.LiveGridMetaData=Class.create();
Rico.LiveGridMetaData.prototype={initialize:function(a,b,c,d){this.pageSize=a;this.totalRows=b;this.setOptions(d);this.scrollArrowHeight=16;this.columnCount=c},setOptions:function(a){this.options={largeBufferSize:7,nearLimitFactor:.2}.extend(a||{})},getPageSize:function(){return this.pageSize},getTotalRows:function(){return this.totalRows},setTotalRows:function(a){this.totalRows=a},getLargeBufferSize:function(){return parseInt(this.options.largeBufferSize*this.pageSize)},getLimitTolerance:function(){return parseInt(this.getLargeBufferSize()*
this.options.nearLimitFactor)}};Rico.LiveGridScroller=Class.create();
Rico.LiveGridScroller.prototype={initialize:function(a,b){this.isIE=0<=navigator.userAgent.toLowerCase().indexOf("msie");this.liveGrid=a;this.metaData=a.metaData;this.createScrollBar();this.scrollTimeout=null;this.lastScrollPos=0;this.viewPort=b;this.rows=[]},isUnPlugged:function(){return null==this.scrollerDiv.onscroll},plugin:function(){this.scrollerDiv.onscroll=this.handleScroll.bindAsEventListener(this)},unplug:function(){this.scrollerDiv.onscroll=null},sizeIEHeaderHack:function(){if(this.isIE){var a=
$(this.liveGrid.tableId+"_header");a&&(a.rows[0].cells[0].style.width=a.rows[0].cells[0].offsetWidth+1+"px")}},createScrollBar:function(){var a=this.liveGrid.viewPort.visibleHeight();this.scrollerDiv=document.createElement("div");var b=this.scrollerDiv.style;b.borderRight="1px solid #ababab";b.position="relative";b.left=this.isIE?"-6px":"-3px";b.width="19px";b.height=a+"px";b.overflow="auto";this.heightDiv=document.createElement("div");this.heightDiv.style.width="1px";this.heightDiv.style.height=
parseInt(a*this.metaData.getTotalRows()/this.metaData.getPageSize())+"px";this.scrollerDiv.appendChild(this.heightDiv);this.scrollerDiv.onscroll=this.handleScroll.bindAsEventListener(this);a=this.liveGrid.table;a.parentNode.parentNode.insertBefore(this.scrollerDiv,a.parentNode.nextSibling)},updateSize:function(){var a=this.viewPort.visibleHeight();this.heightDiv.style.height=parseInt(a*this.metaData.getTotalRows()/this.metaData.getPageSize())+"px"},rowToPixel:function(a){return a/this.metaData.getTotalRows()*
this.heightDiv.offsetHeight},moveScroll:function(a){this.scrollerDiv.scrollTop=this.rowToPixel(a);if(this.metaData.options.onscroll)this.metaData.options.onscroll(this.liveGrid,a)},handleScroll:function(){this.scrollTimeout&&clearTimeout(this.scrollTimeout);var a=parseInt(this.scrollerDiv.scrollTop/this.viewPort.rowHeight);this.liveGrid.requestContentRefresh(a);this.viewPort.scrollTo(this.scrollerDiv.scrollTop);if(this.metaData.options.onscroll)this.metaData.options.onscroll(this.liveGrid,a);this.scrollTimeout=
setTimeout(this.scrollIdle.bind(this),1200)},scrollIdle:function(){if(this.metaData.options.onscrollidle)this.metaData.options.onscrollidle()}};Rico.LiveGridBuffer=Class.create();
Rico.LiveGridBuffer.prototype={initialize:function(a,b){this.size=this.startPos=0;this.metaData=a;this.rows=[];this.updateInProgress=!1;this.viewPort=b;this.maxBufferSize=2*a.getLargeBufferSize();this.maxFetchSize=a.getLargeBufferSize();this.lastOffset=0},getBlankRow:function(){if(!this.blankRow){this.blankRow=[];for(var a=0;a<this.metaData.columnCount;a++)this.blankRow[a]="&nbsp;"}return this.blankRow},loadRows:function(a){var b=a.getElementsByTagName("rows")[0];this.updateUI="true"==b.getAttribute("update_ui");
a=[];for(var b=b.getElementsByTagName("tr"),c=0;c<b.length;c++)for(var d=a[c]=[],e=b[c].getElementsByTagName("td"),f=0;f<e.length;f++){var g=e[f],h="true"==g.getAttribute("convert_spaces"),g=RicoUtil.getContentAsString(g);d[f]=h?this.convertSpaces(g):g;d[f]||(d[f]="&nbsp;")}return a},update:function(a,b){var c=this.loadRows(a);0==this.rows.length?(this.rows=c,this.size=this.rows.length,this.startPos=b):(b>this.startPos?this.startPos+this.rows.length<b?(this.rows=c,this.startPos=b):(this.rows=this.rows.concat(c.slice(0,
c.length)),this.rows.length>this.maxBufferSize&&(c=this.rows.length,this.rows=this.rows.slice(this.rows.length-this.maxBufferSize,this.rows.length),this.startPos+=c-this.rows.length)):(b+c.length<this.startPos?this.rows=c:(this.rows=c.slice(0,this.startPos).concat(this.rows),this.rows.length>this.maxBufferSize&&(this.rows=this.rows.slice(0,this.maxBufferSize))),this.startPos=b),this.size=this.rows.length)},clear:function(){this.rows=[];this.size=this.startPos=0},isOverlapping:function(a,b){return a<
this.endPos()&&this.startPos<a+b||0==this.endPos()},isInRange:function(a){return a>=this.startPos&&a+this.metaData.getPageSize()<=this.endPos()},isNearingTopLimit:function(a){return a-this.startPos<this.metaData.getLimitTolerance()},endPos:function(){return this.startPos+this.rows.length},isNearingBottomLimit:function(a){return this.endPos()-(a+this.metaData.getPageSize())<this.metaData.getLimitTolerance()},isAtTop:function(){return 0==this.startPos},isAtBottom:function(){return this.endPos()==this.metaData.getTotalRows()},
isNearingLimit:function(a){return!this.isAtTop()&&this.isNearingTopLimit(a)||!this.isAtBottom()&&this.isNearingBottomLimit(a)},getFetchSize:function(a){a=this.getFetchOffset(a);var b=0;a>=this.startPos?(b=this.maxFetchSize+a,b>this.metaData.totalRows&&(b=this.metaData.totalRows),b-=a):(b=this.startPos-a,b>this.maxFetchSize&&(b=this.maxFetchSize));return b},getFetchOffset:function(a){var b=a;a>this.startPos?b=a>this.endPos()?a:this.endPos():a+this.maxFetchSize>=this.startPos&&(b=this.startPos-this.maxFetchSize,
0>b&&(b=0));return this.lastOffset=b},getRows:function(a,b){var c=a-this.startPos,d=c+b;d>this.size&&(d=this.size);for(var e=[],f=0;c<d;c++)e[f++]=this.rows[c];return e},convertSpaces:function(a){return a.split(" ").join("&nbsp;")}};Rico.GridViewPort=Class.create();
Rico.GridViewPort.prototype={initialize:function(a,b,c,d,e){this.lastDisplayedStartPos=0;this.div=a.parentNode;this.table=a;this.rowHeight=b;this.div.style.height=this.rowHeight*c;this.div.style.overflow="hidden";this.buffer=d;this.liveGrid=e;this.visibleRows=c+1;this.startPos=this.lastPixelOffset=0},populateRow:function(a,b){for(var c=0;c<b.length;c++)a.cells[c].innerHTML=b[c]},bufferChanged:function(){this.refreshContents(parseInt(this.lastPixelOffset/this.rowHeight))},clearRows:function(){if(!this.isBlank){for(var a=
0;a<this.visibleRows;a++)this.populateRow(this.table.rows[a],this.buffer.getBlankRow());this.isBlank=!0}},clearContents:function(){this.clearRows();this.scrollTo(0);this.startPos=0;this.lastStartPos=-1},refreshContents:function(a){if(a!=this.lastRowPos||this.isPartialBlank||this.isBlank)if(a+this.visibleRows<this.buffer.startPos||this.buffer.startPos+this.buffer.size<a||0==this.buffer.size)this.clearRows();else{this.isBlank=!1;for(var b=this.buffer.startPos>a,c=b?this.buffer.startPos:a,d=(this.buffer.startPos+
this.buffer.size<a+this.visibleRows?this.buffer.startPos+this.buffer.size:a+this.visibleRows)-c,c=this.buffer.getRows(c,d),e=this.visibleRows-d,d=b?0:d,b=b?e:0,f=0;f<c.length;f++)this.populateRow(this.table.rows[f+b],c[f]);for(f=0;f<e;f++)this.populateRow(this.table.rows[f+d],this.buffer.getBlankRow());this.isPartialBlank=0<e;this.lastRowPos=a}},scrollTo:function(a){this.lastPixelOffset!=a&&(this.refreshContents(parseInt(a/this.rowHeight)),this.div.scrollTop=a%this.rowHeight,this.lastPixelOffset=
a)},visibleHeight:function(){return parseInt(this.div.style.height)}};Rico.LiveGridRequest=Class.create();Rico.LiveGridRequest.prototype={initialize:function(a,b){this.requestOffset=a}};Rico.LiveGrid=Class.create();
Rico.LiveGrid.prototype={initialize:function(a,b,c,d,e){null==e&&(e={});this.tableId=a;this.table=$(a);this.metaData=new Rico.LiveGridMetaData(b,c,this.table.rows[0].cells.length,e);this.buffer=new Rico.LiveGridBuffer(this.metaData);this.viewPort=new Rico.GridViewPort(this.table,this.table.offsetHeight/this.table.rows.length,b,this.buffer,this);this.scroller=new Rico.LiveGridScroller(this,this.viewPort);this.additionalParms=e.requestParameters||[];e.sortHandler=this.sortHandler.bind(this);$(a+"_header")&&
(this.sort=new Rico.LiveGridSort(a+"_header",e));this.unprocessedRequest=this.processingRequest=null;this.initAjax(d);if(e.prefetchBuffer||0<e.prefetchOffset)a=0,e.offset&&(a=e.offset,this.scroller.moveScroll(a),this.viewPort.scrollTo(this.scroller.rowToPixel(a))),e.sortCol&&(this.sortCol=e.sortCol,this.sortDir=e.sortDir),this.requestContentRefresh(a)},resetContents:function(){this.scroller.moveScroll(0);this.buffer.clear();this.viewPort.clearContents()},sortHandler:function(a){this.sortCol=a.name;
this.sortDir=a.currentSort;this.resetContents();this.requestContentRefresh(0)},setRequestParams:function(){this.additionalParms=[];for(var a=0;a<arguments.length;a++)this.additionalParms[a]=arguments[a]},setTotalRows:function(a){this.resetContents();this.metaData.setTotalRows(a);this.scroller.updateSize()},initAjax:function(a){ajaxEngine.registerRequest(this.tableId+"_request",a);ajaxEngine.registerAjaxObject(this.tableId+"_updater",this)},invokeAjax:function(){},handleTimedOut:function(){this.processingRequest=
null;this.processQueuedRequest()},fetchBuffer:function(a){if(!this.buffer.isInRange(a)||this.buffer.isNearingLimit(a))if(this.processingRequest)this.unprocessedRequest=new Rico.LiveGridRequest(a);else{var b=this.buffer.getFetchOffset(a);this.processingRequest=new Rico.LiveGridRequest(a);this.processingRequest.bufferOffset=b;var c=this.buffer.getFetchSize(a);a=[];a.push(this.tableId+"_request");a.push("id="+this.tableId);a.push("page_size="+c);a.push("offset="+b);this.sortCol&&(a.push("sort_col="+
this.sortCol),a.push("sort_dir="+this.sortDir));for(b=0;b<this.additionalParms.length;b++)a.push(this.additionalParms[b]);ajaxEngine.sendRequest.apply(ajaxEngine,a);this.timeoutHandler=setTimeout(this.handleTimedOut.bind(this),2E4)}},requestContentRefresh:function(a){this.fetchBuffer(a)},ajaxUpdate:function(a){try{clearTimeout(this.timeoutHandler),this.buffer.update(a,this.processingRequest.bufferOffset),this.viewPort.bufferChanged()}catch(b){}finally{this.processingRequest=null}this.processQueuedRequest()},
processQueuedRequest:function(){null!=this.unprocessedRequest&&(this.requestContentRefresh(this.unprocessedRequest.requestOffset),this.unprocessedRequest=null)}};Rico.LiveGridSort=Class.create();
Rico.LiveGridSort.prototype={initialize:function(a,b){this.headerTableId=a;this.headerTable=$(a);this.setOptions(b);this.applySortBehavior();this.options.sortCol&&this.setSortUI(this.options.sortCol,this.options.sortDir)},setSortUI:function(a,b){for(var c=this.options.columns,d=0;d<c.length;d++)if(c[d].name==a){this.setColumnSort(d,b);break}},setOptions:function(a){this.options={sortAscendImg:"images/sort_asc.gif",sortDescendImg:"images/sort_desc.gif",imageWidth:9,imageHeight:5,ajaxSortURLParms:[]}.extend(a);
(new Image).src=this.options.sortAscendImg;(new Image).src=this.options.sortDescendImg;this.sort=a.sortHandler;this.options.columns=this.options.columns?this.convertToTableColumns(this.options.columns):this.introspectForColumnInfo()},applySortBehavior:function(){for(var a=this.headerTable.rows[0].cells,b=0;b<a.length;b++)this.addSortBehaviorToColumn(b,a[b])},addSortBehaviorToColumn:function(a,b){this.options.columns[a].isSortable()&&(b.id=this.headerTableId+"_"+a,b.style.cursor="pointer",b.onclick=
this.headerCellClicked.bindAsEventListener(this),b.innerHTML=b.innerHTML+'<span id="'+this.headerTableId+"_img_"+a+'">&nbsp;&nbsp;&nbsp;</span>')},headerCellClicked:function(a){a=(a.target?a.target:a.srcElement).id;a=parseInt(a.substring(a.lastIndexOf("_")+1));var b=this.getSortedColumnIndex();-1!=b?b!=a?(this.removeColumnSort(b),this.setColumnSort(a,Rico.TableColumn.SORT_ASC)):this.toggleColumnSort(b):this.setColumnSort(a,Rico.TableColumn.SORT_ASC);this.options.sortHandler&&this.options.sortHandler(this.options.columns[a])},
removeColumnSort:function(a){this.options.columns[a].setUnsorted();this.setSortImage(a)},setColumnSort:function(a,b){this.options.columns[a].setSorted(b);this.setSortImage(a)},toggleColumnSort:function(a){this.options.columns[a].toggleSort();this.setSortImage(a)},setSortImage:function(a){var b=this.options.columns[a].getSortDirection();a=$(this.headerTableId+"_img_"+a);b==Rico.TableColumn.UNSORTED?a.innerHTML="&nbsp;&nbsp;":b==Rico.TableColumn.SORT_ASC?a.innerHTML='&nbsp;&nbsp;<img width="'+this.options.imageWidth+
'" height="'+this.options.imageHeight+'" src="'+this.options.sortAscendImg+'"/>':b==Rico.TableColumn.SORT_DESC&&(a.innerHTML='&nbsp;&nbsp;<img width="'+this.options.imageWidth+'" height="'+this.options.imageHeight+'" src="'+this.options.sortDescendImg+'"/>')},getSortedColumnIndex:function(){for(var a=this.options.columns,b=0;b<a.length;b++)if(a[b].isSorted())return b;return-1},introspectForColumnInfo:function(){for(var a=[],b=this.headerTable.rows[0].cells,c=0;c<b.length;c++)a.push(new Rico.TableColumn(this.deriveColumnNameFromCell(b[c],
c),!0));return a},convertToTableColumns:function(a){for(var b=[],c=0;c<a.length;c++)b.push(new Rico.TableColumn(a[c][0],a[c][1]))},deriveColumnNameFromCell:function(a,b){var c=void 0!=a.innerText?a.innerText:a.textContent;return c?c.toLowerCase().split(" ").join("_"):"col_"+b}};Rico.TableColumn=Class.create();Rico.TableColumn.UNSORTED=0;Rico.TableColumn.SORT_ASC="ASC";Rico.TableColumn.SORT_DESC="DESC";
Rico.TableColumn.prototype={initialize:function(a,b){this.name=a;this.sortable=b;this.currentSort=Rico.TableColumn.UNSORTED},isSortable:function(){return this.sortable},isSorted:function(){return this.currentSort!=Rico.TableColumn.UNSORTED},getSortDirection:function(){return this.currentSort},toggleSort:function(){this.currentSort==Rico.TableColumn.UNSORTED||this.currentSort==Rico.TableColumn.SORT_DESC?this.currentSort=Rico.TableColumn.SORT_ASC:this.currentSort==Rico.TableColumn.SORT_ASC&&(this.currentSort=
Rico.TableColumn.SORT_DESC)},setUnsorted:function(a){this.setSorted(Rico.TableColumn.UNSORTED)},setSorted:function(a){this.currentSort=a}};
var RicoUtil={getElementsComputedStyle:function(a,b,c){2==arguments.length&&(c=b);var d=$(a);return d.currentStyle?d.currentStyle[b]:document.defaultView.getComputedStyle(d,null).getPropertyValue(c)},createXmlDocument:function(){if(document.implementation&&document.implementation.createDocument){var a=document.implementation.createDocument("","",null);null==a.readyState&&(a.readyState=1,a.addEventListener("load",function(){a.readyState=4;if("function"==typeof a.onreadystatechange)a.onreadystatechange()},
!1));return a}return window.ActiveXObject?Try.these(function(){return new ActiveXObject("MSXML2.DomDocument")},function(){return new ActiveXObject("Microsoft.DomDocument")},function(){return new ActiveXObject("MSXML.DomDocument")},function(){return new ActiveXObject("MSXML3.DomDocument")})||!1:null},getContentAsString:function(a){return void 0!=a.xml?this._getContentAsStringIE(a):this._getContentAsStringMozilla(a)},_getContentAsStringIE:function(a){for(var b="",c=0;c<a.childNodes.length;c++)b+=a.childNodes[c].xml;
return b},_getContentAsStringMozilla:function(a){for(var b=new XMLSerializer,c="",d=0;d<a.childNodes.length;d++)c+=b.serializeToString(a.childNodes[d]);return c},toViewportPosition:function(a){return this._toAbsolute(a,!0)},toDocumentPosition:function(a){return this._toAbsolute(a,!1)},_toAbsolute:function(a,b){if(-1==navigator.userAgent.toLowerCase().indexOf("msie"))return this._toAbsoluteMozilla(a,b);for(var c=0,d=0,e=a;e;){var f=0,g=0;e!=a&&(f=parseInt(this.getElementsComputedStyle(e,"borderLeftWidth")),
g=parseInt(this.getElementsComputedStyle(e,"borderTopWidth")),f=isNaN(f)?0:f,g=isNaN(g)?0:g);c+=e.offsetLeft-e.scrollLeft+f;d+=e.offsetTop-e.scrollTop+g;e=e.offsetParent}b&&(c-=this.docScrollLeft(),d-=this.docScrollTop());return{x:c,y:d}},_toAbsoluteMozilla:function(a,b){for(var c=0,d=0,e=a;e;)c+=e.offsetLeft,d+=e.offsetTop,e=e.offsetParent;for(e=a;e&&e!=document.body&&e!=document.documentElement;)e.scrollLeft&&(c-=e.scrollLeft),e.scrollTop&&(d-=e.scrollTop),e=e.parentNode;b&&(c-=this.docScrollLeft(),
d-=this.docScrollTop());return{x:c,y:d}},docScrollLeft:function(){return window.pageXOffset?window.pageXOffset:document.documentElement&&document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body?document.body.scrollLeft:0},docScrollTop:function(){return window.pageYOffset?window.pageYOffset:document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body?document.body.scrollTop:0}};